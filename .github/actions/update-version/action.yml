name: 'update version'
description: 'common update logic for snapshot and release'
inputs:
  commit:
    required: false
  type:
    required: true
runs:
  using: "composite"
  steps:
    - shell: bash
      name: update snapshot saving folder
      run: |
        type='${{ inputs.type }}'
        if [ "${type,,}" == "snapshot"]
        then perl -p -e "s/t.identity='Techmino'/t.identity='Techmino_Snapshot'/g" -i conf.lua
        fi
    - shell: bash
      run: |
        perl -p -e '
          my $v = "${{ inputs.commit }}";
          $v = "@" . substr $v, 0, 4 if $v;
          s/\@DEV/$v/g
        ' -i version.lua
